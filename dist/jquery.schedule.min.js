!function(t,i,e,s){"use strict";function n(i,e){this.element=i,this.settings=t.extend({},o,e),this._defaults=o,this._name=r,this.init()}var r="jqs",o={mode:"read",display:"full",data:[],hour:"24",days:["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"]};t.extend(n.prototype,{init:function(){var i=this;t(this.element).addClass("jqs"),"edit"===this.settings.mode&&t(this.element).on("click",".jqs-wrapper",function(e){if(t(e.target).hasClass("jqs-select")||t(e.target).parents(".jqs-select").length>0)return!1;var s=Math.round(e.offsetY/20);s>=48&&(s=47),i.add(t(this),"id_"+e.timeStamp,s)}).on("click",".jqs-remove",function(t){}),this.create(),this.settings.data.length>0&&t.each(this.settings.data,function(e,s){t.each(s.periods,function(e,n){var r=t(".jqs-wrapper",i.element).eq(s.day),o=i.positionFormat(n[0]),a=i.positionFormat(n[1]);if(0===a&&(a=48),o<=a){var d="id_"+e+s.day+o+a;i.add(r,d,o,a-o)}else console.error("Invalid period",i.periodInit(o,o+(a-o)))})})},create:function(){t('<table class="jqs-table"><tr></tr></table>').appendTo(t(this.element));for(var i=0;i<7;i++)t('<td><div class="jqs-wrapper"></div></td>').appendTo(t(".jqs-table tr",this.element));t('<div class="jqs-grid"><div class="jqs-grid-head"></div></div>').appendTo(t(this.element));for(var e=0;e<25;e++)t('<div class="jqs-grid-line"><span>'+this.formatHour(e)+"</span></div>").appendTo(t(".jqs-grid",this.element));for(var s=0;s<7;s++)t('<div class="jqs-grid-day">'+this.settings.days[s]+"</div>").appendTo(t(".jqs-grid-head",this.element))},add:function(i,e,s,n){n||(n=1);var r=t('<div class="jqs-select"><div class="jqs-select-placeholder"><span>'+this.periodInit(s,s+n)+"</span></div></div>").css("top",20*s).css("height",20*n).attr("id",e).appendTo(i);if(!this.isValid(r))return console.error("Invalid Period",this.periodInit(s,s+n)),t(r).remove(),!1;if("edit"===this.settings.mode){var o=this;r.draggable({grid:[0,20],containment:"parent",drag:function(i,e){t("span",e.helper).text(o.periodDrag(e))}}).resizable({grid:[0,20],containment:"parent",handles:"n, s",resize:function(i,e){t("span",e.helper).text(o.periodResize(e))}})}},periodInit:function(t,i){return this.periodFormat(t)+" - "+this.periodFormat(i)},periodDrag:function(i){var e=i.position.top/20,s=(t(i.helper).height()+i.position.top)/20;return this.periodFormat(e)+" - "+this.periodFormat(s)},periodResize:function(t){var i=t.position.top/20,e=(t.size.height+t.position.top)/20;return this.periodFormat(i)+" - "+this.periodFormat(e)},periodFormat:function(t){t>=48&&(t=0);var i=Math.floor(t/2);return i<10&&(i="0"+i),i+=t%2==0?":00":":30"},positionFormat:function(t){var i=t.split(":"),e=2*parseInt(i[0]);return 30===parseInt(i[1])&&e++,e},formatHour:function(t){return t>=24&&(t=0),t<10&&(t="0"+t),t+=":00"},isValid:function(i){var e=i.position().top,s=i.position().top+i.height(),n=0,r=0,o=!0;return t(".jqs-select",t(i).parent()).each(function(a,d){d=t(d),i.attr("id")!==d.attr("id")&&(n=d.position().top,r=d.position().top+d.height(),n>e&&n<s&&(o=!1),r>e&&r<s&&(o=!1),n<e&&r>s&&(o=!1),n===e&&r===s&&(o=!1),console.log(e,s,n,r))}),o}}),t.fn[r]=function(i){return this.each(function(){t.data(this,"plugin_"+r)||t.data(this,"plugin_"+r,new n(this,i))})}}(jQuery,window,document);